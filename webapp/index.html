<html>

<head>
    <title>Search iTunes</title>
</head>

<body>
    <input id="term" type="text" maxlength="100">
    <button id="doit">Do it</button>
    <br>
    <div id="json"></div>

    <script src="wasm_exec.js"></script>
    <script type="text/javascript">
        (async () => {
            const go = new Go();
            WebAssembly.instantiateStreaming(fetch("itunes.wasm"), go.importObject).then((result) => {
                go.run(result.instance);
            });

            document.getElementById("doit").onclick = async () => {
                search(document.getElementById("term").value, function (err, json) {
                    var sanitized = json.substring(6, json.length - 4);
                    //console.log('sanitized=', sanitized);

                    var parsed = JSON.parse(sanitized);
                    document.getElementById("json").innerHTML = JSON.stringify(parsed, null, 10);
                });
            };
        })();
    </script>
</body>

</html>